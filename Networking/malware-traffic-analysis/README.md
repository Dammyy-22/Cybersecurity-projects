# Malware Traffic Analysis: Exploit Kit Detection

## Project Overview

This project involves analyzing a packet capture (PCAP) file to investigate suspicious network traffic. The goal was to identify indicators of compromise (IOCs), determine the source of infection, and recover the malicious payloads delivered to the victim machine.

<img width="956" height="455" alt="Http filter" src="https://github.com/user-attachments/assets/b7812868-754e-4728-ad63-13197d051e56" />

## Lab Environment & Tools

* **Hypervisor:** VMware Workstation
* **Operating System:** Windows 10
* **Network Analysis:** Wireshark
* **File Analysis:** HashMyFiles
* **Threat Intelligence:** VirusTotal

## Investigation Methodology

1. **Packet Filtering:** Used Wireshark to filter for `http.request` to isolate web traffic and analyze the Protocol Hierarchy statistics.
   
<img width="956" height="455" alt="Http filter" src="https://github.com/user-attachments/assets/73f61368-577e-407e-af6e-4e87546ec8f7" />


2. **Column Customization:** Added Source Port, Destination Port, and MAC Address columns to the main view to track specific communication flows. <br/><br/>

3. **Payload Extraction:** Used "Export Objects (HTTP)" to extract files transferred during the session. <br/><br/>
   
<img width="960" height="468" alt="http object list" src="https://github.com/user-attachments/assets/8fd24d6b-5aba-465d-8102-a22b8b61be02" />


4. **Hash Verification:** Generated file hashes (MD5/SHA256) using HashMyFiles.

<img width="960" height="433" alt="Files hashes" src="https://github.com/user-attachments/assets/0d8bc47e-932a-4db2-9c86-4561378d36f9" />


5. **Threat Intel Lookup:** Cross-referenced hashes with VirusTotal to confirm malicious signatures.

<img width="955" height="397" alt="jar file" src="https://github.com/user-attachments/assets/a49c8a43-a92c-4f3d-90af-d102a5faec40" />


<img width="957" height="412" alt="not infected file" src="https://github.com/user-attachments/assets/05ce8220-a0ff-471e-a4af-401e57d201b7" />


<img width="960" height="421" alt="flash file" src="https://github.com/user-attachments/assets/02332a19-e51b-4bba-a26f-8480e61594c8" />


## Findings & Indicators of Compromise (IOCs)

### Victim Details

* **IP Address:** 172.16.165.165
* **Hostname:** K34EN6W3N-PC
* **MAC Address:** f0:19:af:02:9b:f1

### Threat Details

* **Compromised IP:** 37.200.69.143
* **Malicious Domain:** trustandprobaterealty.com
* **Exploit URL:** stand.trustandprobaterealty.com

### Recovered Artifacts

| Filename / Description  | MD5 Hash                           | Status       |
|:----------------------- |:---------------------------------- |:------------ |
| **Java Exploit**        | `1e34fdebbf655cebea78b45e43520ddf` | **INFECTED** |
| **Flash (SWF) Exploit** | `7b3baa7d6bb3720f369219789e38d6ab` | **INFECTED** |
| **Clean File**          | `d276c86dcdbcdb6b74ee02496bc90d98` | CLEAN        |

## Conclusion

The analysis confirms that the host `K34EN6W3N-PC` was compromised via a drive-by download from `trustandprobaterealty.com`. The infection vector involved both Java and Flash-based exploits delivered via HTTP.
